<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- General stylesheet -->
    <link rel="stylesheet" type="text/css" href="css/general.css" />
    <!-- Contains Sugar, jQuery, jQuery.my -->
    <link rel="stylesheet" type="text/css" href="https://code.jquery.com/ui/1.10.0/themes/smoothness/jquery-ui.css" />
    <link rel="stylesheet" type="text/css"
        href="https://cdn.jsdelivr.net/jquery.ui.timepicker.addon/1.4.5/jquery-ui-timepicker-addon.min.css" />

        <link href="http://cdnjs.cloudflare.com/ajax/libs/foundicons/3.0.0/foundation-icons.css" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/jquery.ui.timepicker.addon/1.4.5/jquery-ui-sliderAccess.js"></script>
    <script src="js/minimal.js"></script>
    <!-- Contains different rich ui plugins -->
    <script src="js/plugins.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/jquery.ui.timepicker.addon/1.4.5/jquery-ui-timepicker-addon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/jquery.ui.timepicker.addon/1.4.5/jquery-ui-sliderAccess.js"></script>



    <style>
        .my-manifest-19b0h96i #list>div {
            width: 100% !important;
        }
    </style>

</head>

<body>
    <div id="form" style="margin:2%">

        <div id="list" class="mb10"></div>
        <input id="btn-user" type="button" value="Add user">
    </div>
</body>
<script>
    $(function () {
        // onload
        $("#form").my({
            data: {
                name: "",
                list: []
            },
            ui: {
                "#name": "name",
                "#list": { // List control section
                    bind: "list",
                    list: '<div class="br2"></div>',
                    init: function ($control) { // Init plugin
                        $control.sortable({
                            handle: ".fi-list"
                        });
                    },
                    manifest: function (item, index, list) {
                        console.log(list); // Return manifest for an item
                        return this.Forms[item.type];
                    }
                },
                "#btn-user": function (data, val) { // Add user

                    if (null != val) this.InsertItem("user");
                    setTimeout(function () {
                        $('.timepicker-box').timepicker({
                            timeFormat: "HH:mm:ss:l"
                        });
                    }, 100);


                },
                "#btn-link": function (data, val) { // Add link
                    if (null != val) this.InsertItem("link");
                }
            },

            // Function that inserts an item
            InsertItem: function (type) {
                this.my.insert(
                    "#list",
                    $.extend(true, {
                        stamp: Date.now()
                    }, this.Forms[type].data)
                );

            },

            // Child manifests
            Forms: {

                // Child manifest for ‘user’
                "user": {
                    data: {
                        type: "user",
                        timea: "",
                        timeb: "",
                        repeat: ""
                    },
                    init: function ($form) {
                        $form.html([
                            '<span class="fi-list green"></span> &nbsp;',
                            '<input id="timea" type="text" placeholder="Enter Time a" class="w180 timepicker-box"> ',
                            '<input id="timeb" type="text" placeholder="Enter Time b" class="w170 timepicker-box"> ',
                            '<input id="repeat" type="number" class="w100">',
                            '<span class="play_box w80">Play</span>',
                            '<span class="fi-x red o50 pl5"></span>'
                        ].join(""));
                    },
                    ui: {
                        "#timea": "timea",
                        "#timeb": "timeb",
                        "#repeat": "repeat",
                        ".fi-x": {
                            bind: function (data, val) {
                                if (null != val) this.my.remove();
                            },
                            events: "click.my"
                        }
                    }
                },

                // Child manifest for ‘link’
                "link": {
                    data: {
                        type: "link",
                        link: ""
                    },
                    init: function ($form) {
                        $form.html([
                            '<span class="fi-list orange"></span> &nbsp;',
                            '<input id="link" type="text" placeholder="Link" style="width:355px;"> ',
                            '<span class="fi-x red o50 pl5"></span>'
                        ].join(""));
                    },
                    ui: {
                        "#link": "link",
                        ".fi-x": {
                            bind: function (data, val) {
                                if (null != val) this.my.remove();
                            },
                            events: "click.my"
                        }
                    }
                }
            },
            style: {
                " #list>div": "width:400px; border-bottom:1px dotted #aaa;" +
                    "padding:5px 0 10px 0;margin:5px 0;"
            },
            id: "Subform non-uniform list"
        });
    });
</script>


</html>